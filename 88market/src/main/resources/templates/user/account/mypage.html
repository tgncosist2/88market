<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>88마켓 - 마이 페이지</title>
<!-- 마이페이지 CSS -->
<link rel="stylesheet" th:href="@{/css/user/mypage.css}">
<link rel="stylesheet" th:href="@{/css/user/fragments/mypageMain.css}">
<link rel="stylesheet" th:href="@{/css/user/fragments/sales.css}">
<link rel="stylesheet" th:href="@{/css/user/fragments/wishlist.css}">
<link rel="stylesheet" th:href="@{/css/user/mypage/info.css}">
<!-- 외부파일(jQuery, Font Awesome 등) -->
<th:block th:replace="~{components/user/external :: external}"></th:block>
</head>
<body>
	<!-- 헤더 -->
	<th:block th:insert="~{components/user/header :: header}"></th:block>
	
	<!-- 메인 콘텐츠 -->
	<main>
		<div class="main-container">
			<div class="main-content">
			<!-- 사이드바 -->	
			<th:block th:insert="~{fragments/user/user_sidebar :: sidebar(tab=${tab})}"></th:block>
			
        <section class="center-content">
		  <!-- sales -->
		  <th:block th:if="${tab=='sales'}">
		    <th:block th:replace="~{fragments/user/mypageList/sales :: mypageInfo}"/>
		  </th:block>
		
		  <!-- purchase -->
		  <th:block th:if="${tab=='purchase'}">
		    <th:block th:replace="~{fragments/user/mypageList/purchase :: mypageInfo}"/>
		  </th:block>
		
		  <!-- wishlist -->
		  <th:block th:if="${tab=='wishlist'}">
		    <th:block th:replace="~{fragments/user/mypageList/wishlist :: mypageInfo}"/>
		  </th:block>
		  
		  <!-- info -->
		  <th:block th:if="${tab=='info'}">
		    <th:block th:replace="~{fragments/user/mypageList/info :: mypageInfo}"/>
		  </th:block>
		
		  <!-- withdraw -->
		  <th:block th:if="${tab=='withdraw'}">
		    <th:block th:replace="~{fragments/user/mypageList/withdraw :: mypageInfo}"/>
		  </th:block>
		  
		  <!-- default -->
		  <th:block th:if="${tab!='sales' and tab!='purchase' and tab!='wishlist' and tab!='info' and tab!='withdraw'}">
		    <th:block th:replace="~{fragments/user/mypageList/mypageMain :: mypageInfo}"/>
		  </th:block>
        </section>
			</div>
		</div>
	</main>
		<script>
		  document.addEventListener('DOMContentLoaded', () => {
		    document.querySelectorAll('.product-tabs .tab-button').forEach(btn => {
		      btn.addEventListener('click', () => {
		        const prevTab    = document.querySelector('.product-tabs .tab-button.active');
		        const prevCont   = document.querySelector('.tab-content.active');
		        if (prevTab)  prevTab.classList.remove('active');
		        if (prevCont) prevCont.classList.remove('active');
		
		        btn.classList.add('active');
		        document.getElementById(btn.dataset.target).classList.add('active');
		      });
		    });
		  });
		</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // 기존 탭 전환 로직
    document.querySelectorAll('.product-tabs .tab-button').forEach(btn => {
        btn.addEventListener('click', () => {
            const prevTab = document.querySelector('.product-tabs .tab-button.active');
            const prevCont = document.querySelector('.tab-content.active');
            if (prevTab) prevTab.classList.remove('active');
            if (prevCont) prevCont.classList.remove('active');

            btn.classList.add('active');
            document.getElementById(btn.dataset.target).classList.add('active');
        });
    });

    // 상품삭제 링크 클릭 시 삭제 요청
    document.querySelectorAll('.delete-product').forEach(link => {
        link.addEventListener('click', function() {
            const prdNum = this.getAttribute('data-prd-num'); // 삭제할 상품 번호
            
            // 삭제 확인
            if (confirm('정말로 이 상품을 삭제하시겠습니까?')) {
                // URL로 삭제 요청
                axios.get('/mypage/product/delete', {
                    params: {
                        prdNum: prdNum
                    }
                })
                .then(function(response) {
                    alert('상품이 삭제되었습니다.');
                    location.reload();  // 페이지 새로고침
                })
                .catch(function(error) {
                    console.error("상품 삭제 실패:", error);
                    alert('상품 삭제에 실패했습니다.');
                });
            }
        });
    });
});

</script>
		
	<script th:src="@{/js/mypage-tabs.js}"></script>
	<!-- 푸터 -->
	<th:block th:insert="~{components/user/footer :: footer}"></th:block>

	<script th:src="@{/js/mypage-tabs.js}"></script>
	<!-- 다음 주소 API -->
	<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
	<!-- 우편번호 찾기 스크립트 -->
	<script th:src="@{/js/user/postcode.js}" defer></script>
	<!-- 버튼 동작 스크립트 -->
	<script th:src="@{/js/user/mypage/info.js}"></script>
</body>
</html>