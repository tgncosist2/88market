<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>88마켓 - 상세정보</title>
<!-- 상품 상세 CSS -->
<link rel="stylesheet" th:href="@{/css/user/product_detail.css}">
<!-- 외부파일(jQuery, Font Awesome, 파비콘 등) -->
<th:block th:replace="~{components/user/external :: external}"></th:block>
<!-- Slick CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
<!-- Slick Theme (선택) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Slick JS -->
<script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
</head>
<script>
	$(function() {
		  $('.fade').slick({
			    dots: true,
			    infinite: true,
			    speed: 500,
			    fade: true,
			    cssEase: 'linear',
			    arrows: true,
			    prevArrow: '<button class="carousel-nav prev-btn">&lt;</button>',
			    nextArrow: '<button class="carousel-nav next-btn">&gt;</button>'
			  });
		 // 여기에 추가
		$('.card-list-wrapper-items').slick({
			infinite: true,
			slidesToShow: 5,
			slidesToScroll: 5,
			dots: false,
			arrows: true,
		});
});
</script>



<body>
	<!-- 헤더 -->
	<th:block th:insert="~{components/user/header :: header}"></th:block>
	
	<!-- 메인 콘텐츠 -->
	<main class="product-page-container">
		<div class="product-main-content">
			<!-- 왼쪽 영역: 상품 이미지 및 상세 설명 -->
			<section class="product-gallery-section">
				<!-- 메인 이미지 캐러셀 -->
				<div class="main-image-carousel fade">
				<th:block th:each="imgName : ${imgNum}">
				  <div>
				    <img th:src="@{/images/main/{file}(file=${imgName})}" alt="상품 이미지">
				  </div>
				</th:block>
				</div>

				<!-- 상품 정보 -->
				<div class="product-description">
					<h3>상품정보</h3>
					<p th:text="${Product[0].content}">상품내용</p>
				</div>
			</section>

			<!-- 오른쪽 영역: 구매 정보 및 판매자 정보 -->
			<section class="product-purchase-section">
			<div class="purchase-core">
				<!-- 상품 기본 정보 -->
				<div class="product-summary">
					<span class="product-category"> <span th:text="${Product[0].coName}">카테고리</span></span>
					<div class="product-title-wrapper">
					  <h1 th:text="${Product[0].title}">제목</h1>
					</div>
					<div class="price-wrapper">
						<strong class="product-price"><span th:text="${#numbers.formatInteger(Product[0].price, 3, 'COMMA')} + '원'">가격</span></strong> 
					</div>
					<div class="product-meta"><span th:text="|조회 ${Product[0].clickNum}회 · 찜 ${Product[0].favNum}|">조회수,찜</span> </div>
				</div>

				<!-- 상품 거래 조건 -->
				<div class="transaction-specs">
					<div class="spec-item">
						<span class="spec-title">제품상태</span> 
						<span class="spec-value" >중고</span>
					</div>
					<div class="spec-item">
						<span class="spec-title">거래방식</span> 
						<span class="spec-value" th:text="${Product[0].deliveryType == 'Y' ? '택배' : '직거래'}"></span>
					</div>
					<div class="spec-item">
						<span class="spec-title">배송비</span> 
						<span class="spec-value">포함</span>
					</div>
				</div>

				<!-- 행동 버튼 -->
				<div class="action-buttons">
					<button class="wish-btn-border">
						<img th:src="@{/images/productHeart/heart-off.png}" alt="찜하기" class="heart-icon" />
					</button>
					<button class="btn-buy" th:onclick="|location.href='@{/buy}'|">구매하기</button>
				</div>
				</div>

				<!-- 판매자 정보 -->
				<div class="seller-info">
					<h4>가게정보</h4>
					<div class="seller-profile">
						<div class="seller-name">
						 <a th:href="@{/planingSeller(id=${Product[0].prdNum}, comNum=${Product[0].comNum},sellType=${Product[0].sellType})}" style="text-decoration: none; cursor: pointer; color: inherit;">
						 <span th:text="${Product[0].comName}"> 
						  기업명</span></a></div>
					</div>
					<div class="seller-stats">
						<span>거래후기 <b th:text="${ reviewCount }">후기 갯수</b></span>
					</div>

				</div>
				
					<!-- 판매자의 다른 상품 -->
					<th:block th:each="prd, iter : ${products}" th:if="${iter.count <= 3}">
					<h5 th:text="${prd.title}">레이저키요...</h5>
					<div class="seller-other-item">
						<img th:src="@{prd.imgNum}" alt="판매자의 다른 상품">
						<div class="item-info">
						<a th:href="@{ /planingDetail?(id=${prd.prdNum}, comNum=${prd.comNum})}" style="cursor: pointer; color: inherit; text-decoration: none;">
							<p th:text="${prd.content}">레이저 키요 프로 웹캠 풀박</p>
							<strong th:text="|${#numbers.formatInteger(prd.price, 3, 'COMMA')}원|">220,000원</strong> 
						</a>
						</div>
					</div>
					</th:block>
			</section>
		</div>

		<!-- 추천 상품 섹션 -->
		<section class="related-products-section">
			<h2>이런 상품은 어때요?</h2>
			<div class="card-list-wrapper-items multiple-items">
			<!-- 관련 상품 카드 -->
			<th:block th:each="product : ${relatedProducts}">
			    <div class="product-card">
			      <a th:href="@{/planingDetail(id=${product.prdNum}, comNum=${product.comNum})}">
			        <div class="product-image-container">
			          <img th:src="@{/images/main/img3.png}" alt="관련 상품 이미지">
			          <!-- 필요하다면 이미지 동적으로: -->
			          <!-- <img th:src="@{/images/main/{img}(img=${product.imgName})}" alt="관련 상품 이미지"> -->
			        </div>
			        <div class="product-info">
			          <p class="product-name" th:text="${product.title}">상품명</p>
			          <strong class="product-price" 
			                  th:text="|${#numbers.formatInteger(product.price, 3, 'COMMA')}원|">가격</strong>
			          <div class="product-meta-row">
			            <p class="product-meta" ><span th:text="${product.inputDate}">2025-07-07 19:00</span></p>
			            <button class="wish-btn">
			              <img th:src="@{/images/productHeart/heart-off.png}" alt="찜하기" class="heart-icon" />
			            </button>
			          </div>
			        </div>
			      </a>
			    </div>
			  </th:block>
				
			</div>
		</section>
	</main>

	<!-- 푸터 -->
	<th:block th:insert="~{components/user/footer :: footer}"></th:block>
</body>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.wish-btn, .wish-btn-border').forEach(function (btn) {
      btn.addEventListener('click', function (event) {
        event.preventDefault();        // 링크 이동 막기
        event.stopPropagation();      // 상위 <a> 클릭 이벤트 막기

        // 하트 색 토글
        btn.classList.toggle('active');

        // btn 내부의 img 태그 찾기
        const img = btn.querySelector('img');
        if (btn.classList.contains('active')) {
          img.src = '/images/productHeart/heart-on.png';   // 활성 하트 이미지
        } else {
          img.src = '/images/productHeart/heart-off.png';  // 비활성 하트 이미지
        }
      });
    });
  });
</script>
</html>
