<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>88마켓 - 판매등록</title>
<!-- 메인 CSS -->
<link rel="stylesheet" th:href="@{/css/user/seller.css}">
<!-- 외부파일(jQuery, Font Awesome 등) -->
<th:block th:replace="~{components/user/external :: external}"></th:block>
</head>
<body>
	<!-- 헤더 -->
	<th:block th:insert="~{components/user/header :: header}"></th:block>

	<main class="seller-profile-container_seller">
		<div class="profile-main_seller">
			<section class="profile-header_seller">
				<div class="profile-avatar_seller">
					<img th:src="${users.image}" alt="판매자 아바타">
				</div>
				<div class="profile-info_seller">
					<h1 class="seller-name_seller" th:text="${users.nickname}">닉네임</h1>
					<p class="trust-label_seller">신뢰지수</p>
					<div class="trust-bar-container_seller">
						<div class="trust-bar_seller">
							<div class="trust-level_seller"
								th:style="'width: ' + ${users.point / 10.0} + '%;'"></div>
						</div>
						<span class="trust-score_seller"> <span class="score"
							th:text="${users.point}">775</span> <span class="total">/1000</span>점
						</span>
					</div>
				</div>
				<div class="seller-stats_seller">
					<div>
						<p>안전거래</p>
						<strong th:text="${safeCount}">3</strong>
					</div>
					<div id="review">
						<p>전체상품</p>
						<strong th:text="${prdCount}">2</strong>
					</div>
				</div>
			</section>

			<section class="products-section_seller">
				<h2 class="section-title_seller">판매상품</h2>
				<nav class="product-filter-nav_seller">
					<a href="#" class="active_seller" data-filter="all">전체</a> <a
						href="#" data-filter="selling">판매중</a> <a href="#"
						data-filter="reserved">예약중</a> <a href="#" data-filter="sold">판매완료</a>
				</nav>
				<div class="products-header_seller">
					<span class="total-products_seller" th:text="|총 ${prdCount}개|">총
						8개</span>
				</div>

				<!-- 판매상품 반복문 -->
				<div class="product-grid_seller">
					<div th:each="product : ${productList}"
						class="product-card_seller show"
						th:classappend="${product.sellType == 'Y'} ? 'sold-out_seller' : ''"
						th:attr="data-status=${product.appointType == 'Y' ? 'reserved' : (product.sellType == 'Y' ? 'sold' : 'selling')}, data-prd-num=${product.prdNum}"
						style="cursor: pointer;">

						<img th:src="${product.imgDTO.mainImage}"
							th:alt="${product.title}">

						<!-- 예약중/판매완료 오버레이 -->
						<div
							th:if="${product.appointType == 'Y' or product.sellType == 'Y'}"
							class="overlay_seller">
							<p th:text="${product.appointType == 'Y' ? '예약중' : '판매완료'}"></p>
						</div>

						<div class="product-info_seller">
							<p class="product-name_seller" th:text="${product.title}"></p>
							<p class="product-price_seller"
								th:text="${#numbers.formatInteger(product.price, 0, 'COMMA')} + '원'"></p>
							<p class="product-meta_seller"
								th:text="${product.location1} + ' | ' + ${product.inputDate}"></p>

							<!-- 안전거래 태그 -->
							<div th:if="${product.safeType == 'Y'}"
								class="product-tags_seller">
								<span class="tag_seller safe-deal_seller">안전거래</span>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
	</main>

	<!-- 푸터 -->
	<th:block th:insert="~{components/user/footer :: footer}"></th:block>

	<script>
		$(document).ready(
				function() {
					// 페이지 로드 후 초기 설정
					showProducts('all');
					updateProductCount('all');

					// 필터 클릭 이벤트
					$('.product-filter-nav_seller a').click(
							function(e) {
								e.preventDefault();

								// active 클래스 변경
								$('.product-filter-nav_seller a').removeClass(
										'active_seller');
								$(this).addClass('active_seller');

								// 필터에 따른 상품 표시
								const filter = $(this).data('filter');
								showProducts(filter);
								updateProductCount(filter);
							});

					// 상품 카드 클릭 이벤트
					$(document).on('click', '.product-card_seller', function() {
						const prdNum = $(this).data('prd-num');
						window.location.href = '/detail?id=' + prdNum;
					});

					function showProducts(filter) {
						$('.product-card_seller').removeClass('show');

						if (filter === 'all') {
							$('.product-card_seller').addClass('show');
						} else {
							$(
									'.product-card_seller[data-status="'
											+ filter + '"]').addClass('show');
						}
					}

					function updateProductCount(filter) {
						let count = 0;
						if (filter === 'all') {
							count = $('.product-card_seller').length;
						} else {
							count = $('.product-card_seller[data-status="'
									+ filter + '"]').length;
						}
						$('.total-products_seller').text('총 ' + count + '개');
					}
				});
	</script>
</body>
</html>
